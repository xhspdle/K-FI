<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kfi.mybatis.jyi.MyCommCalendarMapper">
	
	<!-- 해당 유저 번호가 가입한 커뮤니티 번호 불러오기 -->
	<sql id="findUserCommNum">
		select comm_num from comm_user_list where user_num=#{user_num}
	</sql>
	
	<!-- 유저가 속한 모든 커뮤니티의 일정 불러오기 -->
	<select id="MyCommCalList" parameterType="int" resultType="commcalendar">
    	select * from comm_calendar where comm_num in(<include refid="findUserCommNum"/>)
	</select>

	<!-- 유저가 속한 모든 커뮤니티 목록 불러오기 -->
	<select id="myCommunityList" parameterType="int" resultType="community">
		select * from community where comm_num in(<include refid="findUserCommNum"/>)
	</select>

	<!-- 유저가 달력에서 선택한 해당 커뮤니티의 일정목록 불러오기 -->
	<select id="selectedCommCalList" parameterType="int" resultType="commcalendar">
    	select * from comm_calendar where comm_num = #{comm_num}
	</select>

</mapper>